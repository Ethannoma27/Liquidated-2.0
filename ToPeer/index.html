<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>贷款利息减免申请函</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f9;
    }

    h1, h2, h3 {
      color: #333;
    }

    .content {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    button {
      padding: 10px 20px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background-color: #0056b3;
    }

    .input-field {
      width: 300px;  /* 缩小输入框宽度 */
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
      display: block;
      font-family: "Source Han Sans", Arial, sans-serif;
      font-size: 16px;
    }

    .page-break {
      page-break-before: always;
    }

    .section-title {
      font-weight: bold;
      margin-top: 10px;
      margin-bottom: 5px;
    }

    hr {
      margin-top: 10px !important;
      margin-bottom: 10px !important;
      border: none;
      border-top: 2px solid #999;
      width: 100%;
    }

    /* 修改金额颜色 */
    .C-value, .D-value {
      color: #003366;
    }


    /* 调整 .align-items 类 */
.align-items {
  font-size: 16px;
  margin-bottom: 4px;  /* 减小段落之间的间距 */
  display: flex;       /* 使用 flex 使其在同一行 */
  align-items: center; /* 默认对齐方式 */
}

/* 调整 strong 标签，使其和冒号对齐 */
.align-items strong {
  margin-right: 8px;   /* 减小标签与输入框之间的间距 */
  vertical-align: middle;  /* 调整为垂直居中，使其和冒号对齐 */
}


/* 输入框样式 */
.input-field {
  width: 300px; /* 设置输入框宽度 */
  padding: 10px; /* 减小输入框的内边距 */
  margin: 4px 0; /* 减小输入框的垂直间距 */
  border: 1px solid #ccc;
  border-radius: 4px;
  font-family: "Source Han Sans", Arial, sans-serif;
  font-size: 16px;
}


      /* 设置隐私提示文字调整，控制 PDF 转换时的显示 */
.privacy-note {
  font-size: 12px;
  color: #777;
  margin-left: 0;  /* 移除默认的左边距 */
  padding-left: 4px; /* 为了控制边距，使它更紧凑地显示 */
  vertical-align: middle;
  font-style: italic;

  /* 通过调整position来实现左移 */ 
  position: relative;
  left: -150px; /* 通过 position 调整元素左移的距离，可以根据需要微调 */
}


#replyDate {
  font-family: Arial, sans-serif; /* 确保字体一致 */
  font-size: 16px; /* 保证字体大小一致 */
  text-decoration: underline; /* 保持下划线 */
  border: none; /* 去掉边框 */
  outline: none; /* 去掉焦点时的边框 */
}



   .center-date {
  display: inline-block;
  text-align: center;  /* 确保日期居中 */
  width: auto;
  margin-left: 10px;  /* 调整日期与右侧文字的间距 */
}


.underlined-date {
  display: inline-block;
  border-bottom: 1px solid #000;
  padding-bottom: 2px;
  font-size: 16px;
  width: 120px;  /* 保持原宽度 */
  margin-right: 6px; /* 保留文字“前”的间距 */
  padding-left: 12px; /* 增加左内边距，使日期稍微右移 */
}


/* 保持日期选择器输入框自适应 */
#dateRequest input {
  font-size: 16px;
  width: auto;  /* 保证输入框宽度自适应 */
  border: none; /* 去除边框 */
  outline: none; /* 去除聚焦时的边框 */
  text-align: left; /* 日期文本左对齐 */
  padding-left: 2px; /* 给输入框添加一点内边距 */
}


#dateRequest {
  display: inline-block;
  text-align: left;  /* 确保文字左对齐 */
  margin-left: 0;    /* 去掉不必要的左边距 */
} 

  /* 隐私声明中的斜体与轻松效果 */
  .privacy-note {
    font-size: 13px;
    color: #888;
    font-style: italic;
    padding-left: 5px; /* 留出一些空间，避免拥挤 */
  }

  /* 强调轻松、舒适的感知 */
  #privacyFooter {
    text-align: center;
    margin-top: 20px;
    font-size: 14px;
    color: #6c757d;
  }

/* 打印时隐藏隐私说明 */
@media print {
  #privacyFooter {
    display: none;
  }
}

  </style> 
</head>
<body>

<div class="content" id="content">
  <h1>关于依法协商贷款利息减免、剩余本金折扣分期的正式申请函（银行专用）</h1>

  <h4>尊敬的贵行：</h4>
  <p>我谨以正式书面形式，就本人在贵行名下的相关贷款事项，依据中华人民共和国现行法律法规，向贵行提出协商申请。</p>
  <p>本函旨在<strong>依法沟通、理性协商、实质化解债务风险并锁定双方权益</strong>，并请贵行在<strong>合法、对等、非压迫的框架内</strong>予以回应。</p>

    <div style="height:10px;"></div>  
  <hr>

  <h2>01｜背景说明：第三方集资诈骗导致的资金损失</h2>
  <p>本人此前所使用的部分贷款资金，系通过第三方网络平台进行资金管理。后该平台被有关部门认定存在集资诈骗等违法行为，直接导致本人合法财产遭受重大损失。</p>
  <p>上述损失并非因本人挥霍、或逃避责任所致，而系<strong>第三方违法行为造成的非可归责风险</strong>。本人依法属于受害人，该事实具备公开信息及司法层面的可核验性。</p>

  <div style="height:10px;"></div>  
  <hr>

  <h2>02｜贷款金额结构说明（优化版）</h2>
  <p>为便于贵行对本笔债务进行风险评估与合规核算，现将贷款资金使用及偿还情况明确列示如下（以贵行系统核算与相互确认为准）：</p> 
  <ul>
    <li><strong>借款本金总额</strong>：人民币 <input type="text" id="loanAmount" class="input-field" placeholder="请输入借款金额" /></li>
    <li><strong>截至目前已偿还金额</strong>（含已计入本金部分）：人民币 <input type="text" id="paidAmount" class="input-field" placeholder="请输入已偿还金额" /></li>
    <li><strong>当前剩余未清偿本金</strong>：人民币 <input type="text" id="remainingAmount" class="input-field" placeholder="自动计算" readonly /></li>
  </ul>

  <hr>

<h2>03｜当前履约困难的现实情况</h2>
<p>在贷款合同签订时，<strong>我未能预见到以下重大变化，导致目前无法继续按照原合同履约：</strong></p>

<div class="section-title">1. 第三方平台违法行为导致的资金损失</div>
<p>部分贷款资金通过第三方平台进行投资，然而该平台因涉及集资诈骗被查处，导致我遭受重大资金损失。这一损失完全由第三方非法行为引起，<strong>非我个人过错</strong>，作为受害人，相关事实可通过司法途径核实。</p>

<div class="section-title">2. 宏观经济下行对收入的影响</div>
<p>随着经济环境持续恶化，本人的收入大幅下降，且短期内无法恢复至贷款签订时的水平，导致还款能力严重不足。<strong>这一经济环境的变化，不仅是不可预见的外部因素，且对我个人的影响深远</strong>。</p>

<div class="section-title">3. 外部因素责任</div>
<p>上述两项因素（第三方平台违法与经济环境变化）直接导致了我目前的履约困难。<strong>这些情况完全由外部因素引起，非我个人可控</strong>，我无法预见这些风险并加以防范，因此，继续按照原合同履行将导致极为不公平的后果，甚至将迫使我面临违约风险。</p>

<p>在此情况下，<strong>继续履行原合同将导致严重的不公平后果</strong>，并使我面临无法按期还款的风险。<strong>因此，提出四折清偿方案（即将剩余本金的40%作为实际还款责任）</strong>，不仅符合《民法典》“情势变更”原则，也能够确保在当前困境下，能够稳定履约，避免违约风险，并最终实现债务的清偿。</p>

  <div style="height:10px;"></div>  
  <hr>

  <h2>04｜法律依据：情势变更与公平协商原则</h2>
  <p>根据《中华人民共和国民法典》第五百三十三条（情势变更原则），在合同基础发生当事人订立合同时无法预见的重大变化，继续履行明显不公平的情形下，当事人有权依法请求变更合同履行方式。</p>
  <p>同时，《民法典》确立公平、自愿、诚实信用原则，鼓励通过协商方式合理调整履约结构。本次申请具备明确、正当的法律基础。</p>

  <div style="height:10px;"></div>  
  <hr>


   <h2>05｜协商请求的具体内容 </h2>
  <p>基于上述事实、法律依据及本人当前实际履约能力，本人提出以下<strong>合理清偿且明确、可执行的协商方案</strong>：</p>

  <div class="section-title">第一步｜费用处理原则</div> 
  <ul>
    <li>请求对截至目前产生的<strong>全部利息、罚息、复利及相关费用予以一次性减免</strong>，不再作为后续计算或附加条件。</li>
  </ul>

  <div class="section-title">第二步｜本金折扣确认</div>
  <ul>
    <li>以剩余未清偿本金 <strong class="C-value">C 元</strong> 为基数，申请按 <strong>40%（四折）</strong> 比例确认实际清偿责任。</li>
    <li>即：</li>
    <ul>
      <li>剩余本金：<strong class="C-value">C 元</strong></li>
      <li>协商确认的应还本金总额：<strong class="D-value">D 元</strong></li>
    </ul>
  </ul>

  <div class="section-title">第三步｜分期履行方式</div>
  <ul>
    <li>上述 <strong class="D-value">D 元</strong> 以分期方式偿还；</li>

  <li><strong>分期期数及单期金额</strong>，可在双方确认本人当前真实收入与履约能力后协商确定。</li>
  <li>本人将<strong>优先偿还</strong>已与部分平台达成<strong>四折折扣</strong>的贷款部分。此安排旨在通过优先清偿已达成折扣协议的债务，推动<strong>整体债务的高效解决</strong>。</li>
</ul>


  </ul>
     <div style="height:30px;"></div>  


  <h2>06｜四折方案与权益锁定（风控审批版）</h2>
  <ul>
    <li>本金折扣及分期履行：以剩余未清偿本金<strong class="C-value">C 元</strong> 为基数，确认实际应还本金<strong>40%（四折） = <strong class="D-value">D 元</strong></strong>。</li>
    <li>分期偿还<strong class="D-value">D 元</strong>，分期期数及金额根据双方确认的履约能力确定。</li>
    <li>该方案可形成稳定现金流，降低长期挂账及追偿风险。</li>
    <li>费用及利息处理：已产生的<strong>全部利息、罚息及复利</strong>一次性减免。</li>
  </ul>

     <div style="height:10px;"></div>  

  <hr>  

  <h2>07｜关于沟通方式、程序边界及法定保护</h2>

<p>为确保双方在协商过程中的合法合规沟通，特此声明以下要求，并依据相关法律法规保护个人权益：</p> 

<ul style="padding-left: 20px; line-height: 1.8; list-style-type: none;">
  <li style="font-weight: bold; padding: 5px; margin-bottom: 3px;">
    <strong style="vertical-align: middle;">沟通渠道原则：</strong> 本次协商及所有相关沟通仅接受贵行通过<strong style="vertical-align: middle;">官方授权电子邮件</strong>进行。任何其他形式的沟通均视为无效。
  </li>
  <li style="background-color: #f5c6cb; font-weight: bold; padding: 12px 18px; border-radius: 5px; display: inline-block;">
    <strong style="vertical-align: middle;">拒绝非书面催收方式：</strong> 本人明确拒绝任何 
    <span style="font-size: 1.1em; font-weight: bold; color: #721c24; vertical-align: middle;">电话催收、短信、微信、语音、或其他非书面高压方式 </span>的催收行为。<br>
  </li>
  <li style="font-weight: bold; padding: 5px;">
    <strong>如贵行在未经书面同意的情况下使用上述方式进行催收，本人有权依法要求停止并保留追究责任的权利。</strong> 

  </li> 
</ul> 

<p>依据《中华人民共和国民法典》第五百五十三条【个人隐私保护】及《中华人民共和国消费者权益保护法》第十六条【消费者知情权、选择权保护】</p> 
<p>相关规定，<strong>本人有权要求合法、合理、非侵扰性的沟通方式。</strong></p> 
<p>同时，根据《民法典》第二百三十七条【合同履行】和《侵害公民个人信息刑事责任相关条款》，贵行应严格遵守法定的框架下本人书面授权的沟通方式。</p> 

      <div style="height:10px;"></div>  
      
  <hr> 
  
<h2>08｜申请函的有效期与沟通频率</h2>

<p>为确保双方在协商过程中的合法合规性，并保护本人合法权益，本申请函设定了以下明确条款：</p>

<ul style="padding-left: 20px; line-height: 1.6; list-style-type: none;">
  <li style="font-weight: bold; padding: 3px; margin-bottom: 2px;">
    <strong style="vertical-align: middle;">有效期：</strong> 本申请函自发出之日起一年内有效，期间内所有协商应在此框架内进行。
  </li>
  <li style="font-weight: bold; padding: 3px; margin-bottom: 2px;">
    <strong style="vertical-align: middle;">沟通频率：</strong> 在有效期内，贵行每月仅可通过书面邮件形式与本人指定邮件进行最多1-2次沟通。超出此频率，本人有权拒绝回应。
  </li>
  <li style="font-weight: bold; padding: 3px; margin-bottom: 2px;">
    <strong style="vertical-align: middle;">未批准后的回应权：</strong> 若在此期间申请未获得批准，或未达成任何正式协商一致，本人有权拒绝进一步回应，并不承担任何额外义务。
  </li>
</ul>


<p><strong>法律依据：</strong></p> 

<p>依据《中华人民共和国民法典》第五百五十三条【情势变更】规定 和《中华人民共和国民法典》第三条【公民的基本权利】和《消费者权益保护法》第十六条【消费者知情权、选择权保护】规定：<br>


<p><strong>本人作为公民</strong>，依法享有<strong>自主选择</strong>和<strong>控制自身事务的权利</strong>，任何外部干预必须符合法律规定并遵循合规原则。在本次债务协商中，本人有权行使<strong>知情权</strong>、<strong>选择权</strong>和<strong>拒绝权</strong>，要求银行尊重我的意愿和合法权益。</p>


<p><strong>本人有权选择</strong>合理、非侵扰性的沟通方式，并<strong>拒绝</strong>任何<strong>非书面形式</strong>或<strong>非法催收行为</strong>。<strong>银行应</strong>严格遵守法律规定，确保沟通过程<strong>合法</strong>、<strong>合规</strong>。</p>

<div style="height:10px;"></div>  

<hr> 

<h2>09｜请求依法履行内部合规及上级报批程序</h2>
<p>以下是本次协商申请的简化流程图示，便于贵行理解与执行：</p>

<div style="padding-left: 20px; margin-top: 5px;">
  <div style="margin-bottom: 4px; display: flex; align-items: flex-start;">
    <strong style="width: 30px; text-align: center;">1.</strong>
    <strong style="width: 200px;">申请接收与初审</strong>
    <span>➔ 贵行前端收到申请函后，进行初步评估。</span>
  </div>
  <div style="margin-bottom: 4px; display: flex; align-items: flex-start;">
    <strong style="width: 30px; text-align: center;">2.</strong>
    <strong style="width: 200px;">上级决策与批准</strong>
    <span>➔ 提交上级审批层确认与审批协商方案。</span> 
  </div>
  <div style="margin-bottom: 4px; display: flex; align-items: flex-start;"> 
    <strong style="width: 30px; text-align: center;">3.</strong>
    <strong style="width: 200px;">沟通与协商落实</strong>
    <span>➔ 双方确认协商方案，执行分期还款、利息减免等调整方案。</span>
  </div>
  <div style="margin-bottom: 4px; display: flex; align-items: flex-start;">
    <strong style="width: 30px; text-align: center;">4.</strong>
    <strong style="width: 200px;">后续履约与跟进</strong>
    <span>➔ 定期跟进履约情况，确保双方合约执行。</span>
  </div>
</div>

      <div style="height:10px;"></div>  
  <hr> 

  <h2>10｜回应期限与协商期间安排</h2> 

  <p>
  请贵行于
  <span class="underlined-date" id="dateRequest">
    <input type="date" id="date" class="input-field" />
  </span>
  <span style="margin-left:6px;">前给予正式书面回复。</span>  
</p>


  <p>在协商期间，请贵行暂停任何非协商性催收行为。如有其他合规处理建议，亦请提前书面沟通并取得共识。</p> 

  <div style="height:15px;"></div> 

  <p>本人始终秉持契约意识与合作态度，当前仅在法律保护框架内，依法主张协商权利，以实现债务的理性、稳定解决。</p> 
  <p>期待贵行基于公平、审慎及风险化解原则，予以认真考虑。</p> 

  <p>此致</p>
  <p>敬礼</p>

<!-- 申请人信息 -->
<!-- 申请人信息 -->
<h2>申请人信息</h2>

<div class="align-items">
  <strong>申请人：</strong><input type="text" class="input-field" id="applicant" placeholder="请输入申请人姓名">
</div>
<div class="align-items">
  <strong>联系方式：</strong><input type="email" class="input-field" id="contact" placeholder="请输入邮箱">
</div>
<div class="align-items">
  <strong>身份证号（后四位）：</strong><input type="text" class="input-field" id="idNumber" placeholder="请输入身份证后四位"><span class="privacy-note">（本人隐私，严禁外泄）</span>
</div>
<div class="align-items">
  <strong>日期：</strong>
  <input type="date" class="input-field" id="applicantDate">
</div>


<div>
  <button id="downloadBtn">生成 PDF</button>
</div> 

<!-- 页脚隐私安全说明 -->
<div id="privacyFooter" class="privacy-footer">
<p>隐私声明：此申请函及个人信息仅通过本地浏览器生成 PDF，数据只存储在您的电脑，不会上传至服务器，确保隐私安全。</p> 

</div>
 
<script src="../libs/jspdf.umd.min.js"></script>
<script src="../libs/html2canvas.min.js"></script> 

<script>
 // ======================
// 表单输入监听
// ======================
document.getElementById("applicant").addEventListener("input", function() {
  console.log("申请人姓名: " + this.value);
});

document.getElementById("contact").addEventListener("input", function() {
  console.log("联系方式: " + this.value);
});

document.getElementById("idNumber").addEventListener("input", function() {
  console.log("身份证后四位: " + this.value);
});

document.getElementById("date").addEventListener("change", function() {
  console.log("恳请贵行于日期: " + this.value);
});

document.getElementById("applicantDate").addEventListener("change", function() {
  console.log("申请人信息日期: " + this.value);
});

// ======================
// 金额实时计算
// ======================
function updateAmounts() {
  const loanAmount = parseFloat(document.getElementById("loanAmount").value) || 0;
  const paidAmount = parseFloat(document.getElementById("paidAmount").value) || 0;

  let C = loanAmount - paidAmount;
  if (C < 0) C = 0;

  const D = C * 0.4;

  document.getElementById("remainingAmount").value = C.toFixed(2);

  document.querySelectorAll(".C-value").forEach(el => {
    el.textContent = C.toFixed(2) + " 元";
  });

  document.querySelectorAll(".D-value").forEach(el => {
    el.textContent = D.toFixed(2) + " 元";
  });

  return { loanAmount, paidAmount, C, D };
}

document.getElementById("loanAmount").addEventListener("input", updateAmounts);
document.getElementById("paidAmount").addEventListener("input", updateAmounts);

// ======================
// 生成 PDF（核心功能）
// ======================
document.getElementById("downloadBtn").addEventListener("click", async () => {
  const downloadBtn = document.getElementById("downloadBtn");
  const privacyFooter = document.getElementById("privacyFooter"); // 获取隐私声明元素

  // 隐藏隐私声明，防止它出现在 PDF 中
  if (privacyFooter) {
    privacyFooter.style.display = "none";
  }

  // 隐藏“生成 PDF”按钮，防止它出现在 PDF 中
  downloadBtn.style.display = 'none';

  // 更新金额字段
  updateAmounts();

  const inputFields = document.querySelectorAll('.input-field');
  inputFields.forEach(input => {
    input.style.border = 'none'; // 隐藏输入框的边框，避免干扰PDF的样式
  });

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF("p", "mm", "a4");

  const content = document.getElementById("content");

  try {
    // 使用 html2canvas 将页面内容转换为图片
    const canvas = await html2canvas(content, {
      scale: 2,
      useCORS: true,
      backgroundColor: "#ffffff", // 背景设置为白色
      letterRendering: true,
      scrollY: -window.scrollY, // 修正滚动条位置，确保整个页面内容被捕获
    });

    const imgData = canvas.toDataURL("image/png");

    const pageWidth = 210; // A4纸的宽度（单位：mm）
    const pageHeight = 297; // A4纸的高度（单位：mm）

    const margin = 10; // 页边距
    const imgWidth = pageWidth - margin * 2;
    const imgHeight = canvas.height * imgWidth / canvas.width;

    let heightLeft = imgHeight;
    let position = margin;

    // 将页面内容添加到 PDF 中
    doc.addImage(imgData, "PNG", margin, position, imgWidth, imgHeight);
    heightLeft -= pageHeight;

    while (heightLeft > 0) {
      position = heightLeft - imgHeight + margin;
      doc.addPage();
      doc.addImage(imgData, "PNG", margin, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
    }

    // 保存 PDF 文件
    doc.save("贷款利息减免申请函.pdf");

  } catch (err) {
    console.error("PDF 生成失败：", err);
    alert("生成 PDF 失败，请查看控制台");
  }

  // 恢复“生成 PDF”按钮显示
  downloadBtn.style.display = 'block';

  // 恢复输入框边框样式
  inputFields.forEach(input => {
    input.style.border = '';
  });

  // 恢复隐私声明显示
  if (privacyFooter) {
    privacyFooter.style.display = "block";
  }
});

// ======================
// 页面加载默认日期
// ======================
window.addEventListener('DOMContentLoaded', function () {
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, '0');
  const dd = String(today.getDate()).padStart(2, '0');
  const todayString = `${yyyy}-${mm}-${dd}`;

  // 设置“申请人信息”日期为今天
  const applicantDateInput = document.getElementById("applicantDate");
  if (applicantDateInput) {
    applicantDateInput.value = todayString;
  }

  // 设置“恳请贵行于”日期为一年后
  const nextYear = new Date(today);
  nextYear.setFullYear(nextYear.getFullYear() + 1);
  const nextYyyy = nextYear.getFullYear();
  const nextMm = String(nextYear.getMonth() + 1).padStart(2, '0');
  const nextDd = String(nextYear.getDate()).padStart(2, '0');
  const nextYearString = `${nextYyyy}-${nextMm}-${nextDd}`;

  const requestDateInput = document.getElementById("date");
  if (requestDateInput) {
    requestDateInput.value = nextYearString;
  }
});

</script>  



</body>   
</html>       